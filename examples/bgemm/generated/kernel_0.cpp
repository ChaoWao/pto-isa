#if defined(__CCE__)
#define MEMORY_BASE
#endif
#include "kernel_operator.h"
#include <cstdint>
#include "common/pto_instr.hpp"
using namespace pto;
extern "C" AICORE void bgemm_kernel(__gm__ int64_t* args) {
  int32_t v1 = (int32_t)args[0];
  __gm__ half* v2 = (__gm__ half*)(args[1]);
  __gm__ half* v3 = (__gm__ half*)(args[2]);
  __gm__ float* v4 = (__gm__ float*)(args[3]);
  unsigned v5 = 1;
  unsigned v6 = 0;
  int32_t v7 = 256;
  int32_t v8 = 1;
  int32_t v9 = 128;
  int32_t v10 = 64;
  int32_t v11 = 0;
  int64_t v12 = 0;
  int64_t v13 = 16384;
  int32_t v14 = 2;
  int32_t v15 = 4;
  bool v16 = -1;
  using T = float;
  Tile<TileType::Mat, half, 128, 64, BLayout::RowMajor, 128, 64> v17 = Tile<TileType::Mat, half, 128, 64, BLayout::RowMajor, 128, 64>();
  TASSIGN(v17, v12);
  Tile<TileType::Mat, half, 128, 64, BLayout::ColMajor, 128, 64, SLayout::RowMajor, 512, PadValue::Null> v18 = Tile<TileType::Mat, half, 128, 64, BLayout::ColMajor, 128, 64, SLayout::RowMajor, 512, PadValue::Null>();
  TASSIGN(v18, v12);
  Tile<TileType::Mat, half, 64, 256, BLayout::RowMajor, 64, 256> v19 = Tile<TileType::Mat, half, 64, 256, BLayout::RowMajor, 64, 256>();
  TASSIGN(v19, v13);
  Tile<TileType::Mat, half, 64, 256, BLayout::RowMajor, 64, 256, SLayout::ColMajor, 512, PadValue::Null> v20 = Tile<TileType::Mat, half, 64, 256, BLayout::RowMajor, 64, 256, SLayout::ColMajor, 512, PadValue::Null>();
  TASSIGN(v20, v13);
  Tile<TileType::Left, half, 128, 64, BLayout::RowMajor, 128, 64> v21 = Tile<TileType::Left, half, 128, 64, BLayout::RowMajor, 128, 64>();
  TASSIGN(v21, v12);
  Tile<TileType::Left, half, 128, 64, BLayout::RowMajor, 128, 64, SLayout::RowMajor, 512, PadValue::Null> v22 = Tile<TileType::Left, half, 128, 64, BLayout::RowMajor, 128, 64, SLayout::RowMajor, 512, PadValue::Null>();
  TASSIGN(v22, v12);
  Tile<TileType::Right, half, 64, 256, BLayout::RowMajor, 64, 256> v23 = Tile<TileType::Right, half, 64, 256, BLayout::RowMajor, 64, 256>();
  TASSIGN(v23, v12);
  Tile<TileType::Right, half, 64, 256, BLayout::RowMajor, 64, 256, SLayout::ColMajor, 512, PadValue::Null> v24 = Tile<TileType::Right, half, 64, 256, BLayout::RowMajor, 64, 256, SLayout::ColMajor, 512, PadValue::Null>();
  TASSIGN(v24, v12);
  Tile<TileType::Acc, float, 128, 256, BLayout::RowMajor, 128, 256> v25 = Tile<TileType::Acc, float, 128, 256, BLayout::RowMajor, 128, 256>();
  TASSIGN(v25, v12);
  Tile<TileType::Acc, float, 128, 256, BLayout::ColMajor, 128, 256, SLayout::RowMajor, 1024, PadValue::Null> v26 = Tile<TileType::Acc, float, 128, 256, BLayout::ColMajor, 128, 256, SLayout::RowMajor, 1024, PadValue::Null>();
  TASSIGN(v26, v12);
  bool v27 = v1 < v8;
  set_flag(PIPE_MTE3, PIPE_M, EVENT_ID0);
  set_flag(PIPE_MTE1, PIPE_MTE2, EVENT_ID1);
  set_flag(PIPE_MTE1, PIPE_MTE2, EVENT_ID2);
  if (v27) {
    if (v16) {
      int32_t v28 = v1 * v7;
      for (int32_t i29 = v11; i29 < v14; i29 += v8) {
        int32_t v30 = i29 * v9;
        int32_t v31 = v28 + v30;
        for (int32_t j32 = v11; j32 < v8; j32 += v8) {
          int32_t v33 = j32 * v7;
          unsigned v34 = (unsigned) v8;
          unsigned v35 = v6 * v34;
          unsigned v36 = v6 + v35;
          unsigned v37 = (unsigned) v8;
          unsigned v38 = v6 * v37;
          unsigned v39 = v36 + v38;
          unsigned v40 = (unsigned) v8;
          unsigned v41 = v6 * v40;
          unsigned v42 = v39 + v41;
          unsigned v43 = (unsigned) v31;
          unsigned v44 = (unsigned) v7;
          unsigned v45 = v43 * v44;
          unsigned v46 = v42 + v45;
          unsigned v47 = (unsigned) v8;
          unsigned v48 = v6 * v47;
          unsigned v49 = v46 + v48;
          __gm__ half* v50 = v2 + v49;
          using GTShape_141455680 = pto::Shape<1, 1, 1, 128, 64>;
          using GTStride_141455680 = pto::Stride<1, 1, 1, 256, 1>;
          GTShape_141455680 v51 = GTShape_141455680();
          GTStride_141455680 v52 = GTStride_141455680();
          using GT_141455680 = GlobalTensor<half, GTShape_141455680, GTStride_141455680, pto::Layout::ND>;
          GT_141455680 v53 = GT_141455680(v50, v51, v52);
          TLOAD(v18, v53);
          set_flag(PIPE_MTE2, PIPE_MTE1, EVENT_ID0);
          unsigned v54 = (unsigned) v8;
          unsigned v55 = v6 * v54;
          unsigned v56 = v6 + v55;
          unsigned v57 = (unsigned) v8;
          unsigned v58 = v6 * v57;
          unsigned v59 = v56 + v58;
          unsigned v60 = (unsigned) v8;
          unsigned v61 = v6 * v60;
          unsigned v62 = v59 + v61;
          unsigned v63 = (unsigned) v28;
          unsigned v64 = (unsigned) v8;
          unsigned v65 = v63 * v64;
          unsigned v66 = v62 + v65;
          unsigned v67 = (unsigned) v33;
          unsigned v68 = (unsigned) v7;
          unsigned v69 = v67 * v68;
          unsigned v70 = v66 + v69;
          __gm__ half* v71 = v3 + v70;
          using GTShape_141145648 = pto::Shape<1, 1, 1, 64, 256>;
          using GTStride_141145648 = pto::Stride<1, 1, 1, 1, 256>;
          GTShape_141145648 v72 = GTShape_141145648();
          GTStride_141145648 v73 = GTStride_141145648();
          using GT_141145648 = GlobalTensor<half, GTShape_141145648, GTStride_141145648, pto::Layout::DN>;
          GT_141145648 v74 = GT_141145648(v71, v72, v73);
          TLOAD(v20, v74);
          set_flag(PIPE_MTE2, PIPE_MTE1, EVENT_ID1);
          wait_flag(PIPE_MTE2, PIPE_MTE1, EVENT_ID0);
          TMOV(v22, v18);
          pipe_barrier(PIPE_ALL);
          wait_flag(PIPE_MTE2, PIPE_MTE1, EVENT_ID1);
          TMOV(v24, v20);
          pipe_barrier(PIPE_ALL);
          set_flag(PIPE_MTE1, PIPE_M, EVENT_ID0);
          set_flag(PIPE_MTE1, PIPE_MTE2, EVENT_ID0);
          wait_flag(PIPE_MTE1, PIPE_M, EVENT_ID0);
          wait_flag(PIPE_MTE3, PIPE_M, EVENT_ID0);
          TMATMUL(v26, v22, v24);
          pipe_barrier(PIPE_ALL);
          set_flag(PIPE_M, PIPE_MTE1, EVENT_ID0);
          set_flag(PIPE_M, PIPE_MTE3, EVENT_ID0);
          wait_flag(PIPE_MTE1, PIPE_MTE2, EVENT_ID0);
          wait_flag(PIPE_M, PIPE_MTE1, EVENT_ID0);
          for (int32_t k75 = v8; k75 < v15; k75 += v8) {
            int32_t v76 = k75 * v10;
            unsigned v77 = (unsigned) v8;
            unsigned v78 = v6 * v77;
            unsigned v79 = v6 + v78;
            unsigned v80 = (unsigned) v8;
            unsigned v81 = v6 * v80;
            unsigned v82 = v79 + v81;
            unsigned v83 = (unsigned) v8;
            unsigned v84 = v6 * v83;
            unsigned v85 = v82 + v84;
            unsigned v86 = (unsigned) v31;
            unsigned v87 = (unsigned) v7;
            unsigned v88 = v86 * v87;
            unsigned v89 = v85 + v88;
            unsigned v90 = (unsigned) v76;
            unsigned v91 = (unsigned) v8;
            unsigned v92 = v90 * v91;
            unsigned v93 = v89 + v92;
            __gm__ half* v94 = v2 + v93;
            using GTShape_141145312 = pto::Shape<1, 1, 1, 128, 64>;
            using GTStride_141145312 = pto::Stride<1, 1, 1, 256, 1>;
            GTShape_141145312 v95 = GTShape_141145312();
            GTStride_141145312 v96 = GTStride_141145312();
            using GT_141145312 = GlobalTensor<half, GTShape_141145312, GTStride_141145312, pto::Layout::ND>;
            GT_141145312 v97 = GT_141145312(v94, v95, v96);
            wait_flag(PIPE_MTE1, PIPE_MTE2, EVENT_ID1);
            TLOAD(v18, v97);
            set_flag(PIPE_MTE2, PIPE_MTE1, EVENT_ID2);
            int32_t v98 = v28 + v76;
            unsigned v99 = (unsigned) v8;
            unsigned v100 = v6 * v99;
            unsigned v101 = v6 + v100;
            unsigned v102 = (unsigned) v8;
            unsigned v103 = v6 * v102;
            unsigned v104 = v101 + v103;
            unsigned v105 = (unsigned) v8;
            unsigned v106 = v6 * v105;
            unsigned v107 = v104 + v106;
            unsigned v108 = (unsigned) v98;
            unsigned v109 = (unsigned) v8;
            unsigned v110 = v108 * v109;
            unsigned v111 = v107 + v110;
            unsigned v112 = (unsigned) v33;
            unsigned v113 = (unsigned) v7;
            unsigned v114 = v112 * v113;
            unsigned v115 = v111 + v114;
            __gm__ half* v116 = v3 + v115;
            using GTShape_141108928 = pto::Shape<1, 1, 1, 64, 256>;
            using GTStride_141108928 = pto::Stride<1, 1, 1, 1, 256>;
            GTShape_141108928 v117 = GTShape_141108928();
            GTStride_141108928 v118 = GTStride_141108928();
            using GT_141108928 = GlobalTensor<half, GTShape_141108928, GTStride_141108928, pto::Layout::DN>;
            GT_141108928 v119 = GT_141108928(v116, v117, v118);
            wait_flag(PIPE_MTE1, PIPE_MTE2, EVENT_ID2);
            TLOAD(v20, v119);
            set_flag(PIPE_MTE2, PIPE_MTE1, EVENT_ID3);
            wait_flag(PIPE_MTE2, PIPE_MTE1, EVENT_ID2);
            TMOV(v22, v18);
            pipe_barrier(PIPE_ALL);
            set_flag(PIPE_MTE1, PIPE_MTE2, EVENT_ID1);
            wait_flag(PIPE_MTE2, PIPE_MTE1, EVENT_ID3);
            TMOV(v24, v20);
            pipe_barrier(PIPE_ALL);
            set_flag(PIPE_MTE1, PIPE_MTE2, EVENT_ID2);
            TMATMUL_ACC(v26, v26, v22, v24);
            pipe_barrier(PIPE_ALL);
          }
          unsigned v120 = (unsigned) v8;
          unsigned v121 = v6 * v120;
          unsigned v122 = v6 + v121;
          unsigned v123 = (unsigned) v8;
          unsigned v124 = v6 * v123;
          unsigned v125 = v122 + v124;
          unsigned v126 = (unsigned) v8;
          unsigned v127 = v6 * v126;
          unsigned v128 = v125 + v127;
          unsigned v129 = (unsigned) v31;
          unsigned v130 = (unsigned) v7;
          unsigned v131 = v129 * v130;
          unsigned v132 = v128 + v131;
          unsigned v133 = (unsigned) v33;
          unsigned v134 = (unsigned) v8;
          unsigned v135 = v133 * v134;
          unsigned v136 = v132 + v135;
          __gm__ float* v137 = v4 + v136;
          using GTShape_141058064 = pto::Shape<1, 1, 1, 128, 256>;
          using GTStride_141058064 = pto::Stride<1, 1, 1, 256, 1>;
          GTShape_141058064 v138 = GTShape_141058064();
          GTStride_141058064 v139 = GTStride_141058064();
          using GT_141058064 = GlobalTensor<float, GTShape_141058064, GTStride_141058064, pto::Layout::ND>;
          GT_141058064 v140 = GT_141058064(v137, v138, v139);
          wait_flag(PIPE_M, PIPE_MTE3, EVENT_ID0);
          TSTORE(v140, v26);
          set_flag(PIPE_MTE3, PIPE_M, EVENT_ID0);
        }
      }
    }
  }
  pipe_barrier(PIPE_ALL);
  wait_flag(PIPE_MTE3, PIPE_M, EVENT_ID0);
  wait_flag(PIPE_MTE1, PIPE_MTE2, EVENT_ID1);
  wait_flag(PIPE_MTE1, PIPE_MTE2, EVENT_ID2);
  return;
}
